@model IndexResult
@{
    Title = "Search";
}

@section navbar_left {
    <div class="navbar-icons">
        <a class="btn btn-icon" href="@(Url.Action<HomeController>(c => c.Index()))">@Html.SvgIcon("arrow-left")</a>
    </div>
}

<div class="cover pt-4">
    <div class="container">
        @Html.IconImg(128, htmlAttributes: new { @class = "mx-auto d-block" })
        <form action="@Url.Action(nameof(SearchController.Index), typeof(SearchController).ControllerName())" method="get" class="py-4" data-turboform>
            <input class="form-control" type="text" role="search" name="q" value="@Model.Query.Text" placeholder="Search @Theme.GetName()..." />
        </form>
        @if (!string.IsNullOrEmpty(Model.Query.Text)) {
            <nav class="nav nav-tabs">
                <a class="nav-link @(Model.Query.EntityTypes.Count > 1 ? "active" : null)" href="@(Request.Path + Request.QueryString.Rebuild("et", null, "skip", null).AsQueryString())">Everything</a>
                @foreach (EntityType et in ViewBag.EntityTypes) {
                    <a class="nav-link @((Model.Query.EntityTypes.Count == 1 && Model.Query.EntityTypes.SingleOrDefault() == et) ? "active" : null)" href="@(Request.Path + Request.QueryString.Rebuild("et", et.ToString().ToLower(), "skip", null).AsQueryString())">@(et.ToString())s</a>
                }
            </nav>
        }
    </div>
</div>

<div class="container py-4">

    @if (Model.TotalCount == 0 && !string.IsNullOrEmpty(Model.Query.Text)) {
        <p>Your search - <strong>@Model.Query.Text</strong> - did not match anything.</p>
        <p>Suggestions:</p>
        <ul>
            <li>Make sure that all words are spelled correctly.</li>
            <li>Try different keywords.</li>
            <li>Try more general keywords.</li>
            <li>Try fewer keywords.</li>
        </ul>
    }

    @foreach (var item in Model) {
        <article class="search-result py-2">
            @if (item.Title != null) {
                <h5><a href="@item.Url()">@if (item.TitleHighlight != null) {@Html.Raw(item.TitleHighlight) } else { @item.Title}</a></h5>
            }

            @if (item.Description != null) {
                <p><a href="@item.Url()" class="text-dark">@if (item.DescriptionHighlight != null) {@Html.Raw(item.DescriptionHighlight) } else { @item.Description.Ellipsis(256)}</a></p>

            }
        </article>
    }

    @Html.Pagination(Model)

</div>
